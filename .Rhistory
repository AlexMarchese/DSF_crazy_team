print('Hey guys')
library(readr)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data_init <- read_delim("e-shop clothing 2008.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
library(tidyr)
library(tidyverse)
library(magrittr)
library(plot3D)
library(plot3Drgl)
library(car)
library(caret)
summary(data)
mode <- function(codes){
which.max(tabulate(codes))
}
table(data$colour)
table(data$country)
mode(data$colour)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data <- read_delim("e-shop clothing 2008.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
library(tidyr)
library(tidyverse)
library(magrittr)
library(plot3D)
library(plot3Drgl)
library(car)
library(caret)
summary(data)
mode <- function(codes){
which.max(tabulate(codes))
}
table(data$colour)
table(data$country)
mode(data$colour)
mode(data$country)
mode(data$price)
data<-data %>%
group_by(`session ID`)%>%
select(-c(1,2,3))
data_1<-data[,c(1,2,3,4,6,8,9,11)]
data_order<-data_1[,c(1,3)]
data_country<-data_1[,c(2,3)]
data_page1<-data_1[,c(4,3)]
data_col<-data_1[,c(5,3)]
data_model<-data_1[,c(6,3)]
data_price<-data_1[,c(7,3)]
data_page<-data_1[,c(8,3)]
data_price<-data_price %>%
summarise(across(price, mean, na.rm = TRUE))
data_country<-data_country%>%
count(country)
data_country %<>% select(-c(3))
data_model<-aggregate(data_model,
by = list(data_model$`session ID`),
FUN = max)%>%
data_model %<>% select(-c(1))
data_col <- data_col %>%
group_by(`session ID`) %>%
summarise(colour = mode(colour))
data_page_max<-aggregate(data_page,
by = list(data_page$`session ID`),
FUN = max)
data_page_max %<>% select(-c(1))
data_page_mean<-aggregate(data_page,
by = list(data_page$`session ID`),
FUN = mean)
data_page_mean %<>% select(-c(1))
rm(data_page)
data_order<-aggregate(data_order,
by = list(data_order$`session ID`),
FUN = max)
data_order %<>% select(-c(1))
data_page1 <- data_page1 %>%
group_by(`session ID`) %>%
summarise(mode_page1 = mode(`page 1 (main category)`))
middle<-left_join(data_col, data_country)
middle<-left_join(middle,data_model)
middle<-left_join(middle,data_order)
middle<-left_join(middle,data_page_max)
middle<-left_join(middle,data_page_mean, by = "session ID", "session ID")
colnames(middle)[6] <- "Page_max"
colnames(middle)[7] <- "Page_mean"
middle<-left_join(middle,data_page1)
middle<-left_join(middle,data_price)
data<-middle
names(data)
data_n <- aggregate(. ~ `session ID`, data, FUN = mode)
write.csv(data_n, "clean DF.csv")
DS <- read.csv("clean DF.csv")
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
DS <- read.csv("clean DF.csv")
View(DS)
library(readr)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data <- read_delim("e-shop clothing 2008.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(data)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
data <- read_delim("e-shop clothing 2008.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
library(tidyr)
library(tidyverse)
library(magrittr)
library(plot3D)
library(plot3Drgl)
library(car)
library(caret)
summary(data)
mode <- function(codes){
which.max(tabulate(codes))
}
table(data$colour)
table(data$country)
mode(data$colour)
mode(data$country)
mode(data$price)
data<-data %>%
group_by(`session ID`)%>%
select(-c(1,2,3))
data_1<-data[,c(1,2,3,4,6,8,9,11)]
data_order<-data_1[,c(1,3)]
data_country<-data_1[,c(2,3)]
data_page1<-data_1[,c(4,3)]
data_col<-data_1[,c(5,3)]
data_model<-data_1[,c(6,3)]
data_price<-data_1[,c(7,3)]
data_page<-data_1[,c(8,3)]
data_price<-data_price %>%
summarise(across(price, mean, na.rm = TRUE))
data_country<-data_country%>%
count(country)
data_country %<>% select(-c(3))
data_model<-aggregate(data_model,
by = list(data_model$`session ID`),
FUN = max)%>%
data_model %<>% select(-c(1))
data_col <- data_col %>%
group_by(`session ID`) %>%
summarise(colour = mode(colour))
data_page_max<-aggregate(data_page,
by = list(data_page$`session ID`),
FUN = max)
data_page_max %<>% select(-c(1))
data_page_mean<-aggregate(data_page,
by = list(data_page$`session ID`),
FUN = mean)
data_page_mean %<>% select(-c(1))
rm(data_page)
data_order<-aggregate(data_order,
by = list(data_order$`session ID`),
FUN = max)
data_order %<>% select(-c(1))
data_page1 <- data_page1 %>%
group_by(`session ID`) %>%
summarise(mode_page1 = mode(`page 1 (main category)`))
middle<-left_join(data_col, data_country)
middle<-left_join(middle,data_model)
middle<-left_join(middle,data_order)
middle<-left_join(middle,data_page_max)
middle<-left_join(middle,data_page_mean, by = "session ID", "session ID")
colnames(middle)[6] <- "Page_max"
colnames(middle)[7] <- "Page_mean"
middle<-left_join(middle,data_page1)
middle<-left_join(middle,data_price)
data<-middle
names(data)
data_n <- aggregate(. ~ `session ID`, data, FUN = mode)
DS_conc <- aggregate(order ~ session ID, data, max)
DS_conc <- aggregate(order ~ `session ID`, data, max)
View(DS_conc)
DS <- read.csv("clean DF.csv")
DS_cl <- DS %>% select(-c(x, session.ID, Page_mean, mode_page1))
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
DS <- read.csv("clean DF.csv")
DS_cl <- DS %>% select(-c(x, session.ID, Page_mean, mode_page1))
DS_cl <- DS %>% select(-c(X, session.ID, Page_mean, mode_page1))
View(DS_cl)
names(DS_cl$order) = "year"
View(DS_cl)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
DS <- read.csv("clean DF.csv")
DS_cl <- DS %>% select(-c(X, session.ID, Page_mean, mode_page1))
names(DS_cl$order) = "year"
names(DS_cl$order)
col(DS_cl$order) = "year"
DS_cl <- DS %>% select(-c(X, session.ID, Page_mean, mode_page1)) %>% rename(order = `page visits`)
rlang::last_error()
DS_cl <- DS %>% select(-c(X, session.ID, Page_mean, mode_page1)) %>% rename(`page visits` = order)
modelAll = glm(`page visits` ~ ., family = "binomial", data = DS_cl)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
DS_old = read.csv("dataset.csv")
View(DS_old)
View(DS_old)
library(readr)
data <- read_delim("e-shop clothing 2008.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
library(tidyr)
library(tidyverse)
library(magrittr)
library(plot3D)
library(plot3Drgl)
library(car)
library(caret)
summary(data)
mode <- function(codes){
which.max(tabulate(codes))
}
table(data$colour)
table(data$country)
mode(data$colour)
mode(data$country)
mode(data$price)
data<-data %>%
group_by(`session ID`)%>%
select(-c(1,2,3))
data_1<-data[,c(1,2,3,4,6,8,9,11)]
data_order<-data_1[,c(1,3)]
data_country<-data_1[,c(2,3)]
data_page1<-data_1[,c(4,3)]
data_col<-data_1[,c(5,3)]
data_model<-data_1[,c(6,3)]
data_price<-data_1[,c(7,3)]
data_page<-data_1[,c(8,3)]
data_price<-data_price %>%
summarise(across(price, mean, na.rm = TRUE))
data_country<-data_country%>%
count(country)
data_country %<>% select(-c(3))
data_model<-aggregate(data_model,
by = list(data_model$`session ID`),
FUN = max)%>%
data_model %<>% select(-c(1))
data_col <- data_col %>%
group_by(`session ID`) %>%
summarise(colour = mode(colour))
data_page_max<-aggregate(data_page,
by = list(data_page$`session ID`),
FUN = max)
data_page_max %<>% select(-c(1))
data_page_mean<-aggregate(data_page,
by = list(data_page$`session ID`),
FUN = mean)
data_page_mean %<>% select(-c(1))
rm(data_page)
data_order<-aggregate(data_order,
by = list(data_order$`session ID`),
FUN = max)
data_order %<>% select(-c(1))
data_page1 <- data_page1 %>%
group_by(`session ID`) %>%
summarise(mode_page1 = mode(`page 1 (main category)`))
middle<-left_join(data_col, data_country)
middle<-left_join(middle,data_model)
middle<-left_join(middle,data_order)
middle<-left_join(middle,data_page_max)
middle<-left_join(middle,data_page_mean, by = "session ID", "session ID")
colnames(middle)[6] <- "Page_max"
colnames(middle)[7] <- "Page_mean"
middle<-left_join(middle,data_page1)
middle<-left_join(middle,data_price)
data<-middle
colnames(data)[5] <- "Number_of_clicks"
ggplot(data, aes(x= Page_max, y = Number_of_clicks))+geom_line()
ggplot(data, aes(x= Page_max, y = Number_of_clicks))+geom_point()
library(ranger)
library(rsample)
library(dplyr)
library(tidyverse)
library(randomForest)
library(magrittr)
library(caret)
M = read.delim("e-shop clothing 2008.csv",sep = ";")
M$date = paste0(M$year,"0",M$month,M$day)
M$date = as.Date(M$date, tryFormats = "%Y%m%d")
M = M %>%
select(-year,-month,-day)
rm(list = ls())
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
library(ranger)
library(rsample)
library(dplyr)
library(tidyverse)
library(randomForest)
library(magrittr)
library(caret)
M = read.delim("e-shop clothing 2008.csv",sep = ";")
M$date = paste0(M$year,"0",M$month,M$day)
M$date = as.Date(M$date, tryFormats = "%Y%m%d")
View(M)
M = M %>%
select(-year,-month,-day)
hist(M$order)
M = M %>%
filter(order>10) %>%
filter(order< 38)
#Less then 10 clicks is not relevant for our analysis
#Using the boxplot to exclude the extreme value (over 38)
ggplot()+geom_boxplot(aes(M$order))
M = read.delim("e-shop clothing 2008.csv",sep = ";")
M$date = paste0(M$year,"0",M$month,M$day)
M$date = as.Date(M$date, tryFormats = "%Y%m%d")
M = M %>%
select(-year,-month,-day)
hist(M$order)
#Less then 10 clicks is not relevant for our analysis
#Using the boxplot to exclude the extreme value (over 38)
ggplot()+geom_boxplot(aes(M$order))
